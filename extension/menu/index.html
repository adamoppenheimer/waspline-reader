<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    * { box-sizing: border-box; }
    html, body { width: 340px; margin: 0; padding: 0; font-family: sans-serif; }
    body { padding: 10px; }
    h1 { background-image: url("/icons/wasp48.png"); background-size: contain; background-repeat: no-repeat; font-size: 15pt; padding-left: 1.5em; margin: 0 0 8px 0; }
    .hidden { display: none !important; }
    #popup-content { position: relative; }
    .toolbar { display: flex; gap: 10px; margin: 6px 0 10px 0; }
    .toolbar button { flex: 1; padding: 7px 10px; font-weight: 600; min-width: 0; }
    .row { margin: 10px 0; }
    #gradient_size, #node_coverage, #safe_cycle_lines { width: 100%; }
    .subtle { color: #666; font-size: 12px; line-height: 1.3; }
    .divider { height: 1px; background: #e6e6e6; margin: 10px 0; }
    .toast {
      position: absolute; right: 8px; bottom: 8px;
      font-size: 12px; padding: 6px 12px; border-radius: 999px;
      background: #f2f2f2; border: 1px solid #e2e2e2; color: #333;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      pointer-events: none;
      opacity: 0; transform: translateY(4px);
      transition: opacity 180ms ease, transform 180ms ease;
    }
    .toast.visible { opacity: 1; transform: translateY(0); }
    .slider-label { display: flex; justify-content: space-between; align-items: baseline; gap: 10px; }
    .mono { font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 12px; color: #555; }
    select { width: 100%; padding: 6px 8px; font-size: 13px; }
  </style>
</head>

<body>
  <div id="popup-content">
    <h1>WaspLine Reader</h1>

    <div class="toolbar">
      <button id="apply" type="button">Apply</button>
      <button id="restore" type="button">Restore</button>
    </div>

    <div class="row">
      <div class="slider-label">
        <label for="site_mode">Mode</label>
        <span id="site_host" class="mono"></span>
      </div>
      <select id="site_mode">
        <option value="safe">Safe (default)</option>
        <option value="full">Full (more advanced)</option>
      </select>
      <div class="subtle">
        Safe mode is fast and won’t break formatting. Full mode is more “BeeLine-like” but can be slow/brittle on some sites.
      </div>
    </div>

    <!-- NEW: Safe mode line-change speed -->
    <div class="row">
      <div class="slider-label">
        <label for="safe_cycle_lines">Safe: line change speed</label>
        <span id="safe_cycle_lines_value" class="mono">6</span>
      </div>
      <input type="range" id="safe_cycle_lines" min="2" max="30" value="6">
      <div class="subtle">
        Smaller = faster change between consecutive lines (easier line tracking). Larger = smoother/slow shift.
      </div>
    </div>

    <div class="row">
      <div class="slider-label">
        <label for="node_coverage">Coverage</label>
        <span id="node_coverage_value" class="mono">0%</span>
      </div>
      <input type="range" id="node_coverage" min="0" max="100" value="0">
      <div class="subtle">Controls how much text is processed around what you’re currently viewing (min 400 items).</div>
    </div>

    <div class="row">
      <div class="slider-label">
        <label for="gradient_size">Gradient</label>
        <span id="gradient_size_value" class="mono">50%</span>
      </div>
      <input type="range" id="gradient_size" min="0" max="100" value="50">
    </div>

    <div class="row">
      <input type="color" id="color1" name="color1" value="#0000FF">
      <label for="color1">Color 1</label>
    </div>

    <div class="row">
      <input type="color" id="color2" name="color2" value="#FF0000">
      <label for="color2">Color 2</label>
    </div>

    <div class="row">
      <input type="color" id="color_text" name="color_text" value="#000000">
      <label for="color_text">Text Color</label>
    </div>

    <div class="divider"></div>

    <div style="display: flex; flex-direction: column; gap: 8px;">
      <button id="save-my-default" type="button">Save current as my default</button>
      <button id="reset-my-default" type="button">Reset controls to my default</button>
      <button id="reset-ext-default" type="button">Reset controls to extension default</button>
      <div class="subtle">Tip: Changes only appear after clicking Apply.</div>
    </div>

    <div id="toast" class="toast hidden" aria-live="polite">Saved!</div>
  </div>

  <div id="error-content" class="hidden">
    <p>Can't use WaspLine Reader on this web page.</p>
  </div>

  <script src="menu.js"></script>
</body>
</html>
